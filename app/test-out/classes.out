data:
global array vtblA: { mA }
global array fieldsA: { 2, 0 }
global array vtblB: { mB }
global array fieldsB: { 0, 2 }
code:

mA(%this):
	%1 = %this & 1
	if %1 then NotAPointer0 else mA1
NotAPointer0:
	fail NotAPointer
mA1:
	%2 = %this + 8
	%3 = load(%2)
	%4 = getelt(%3, 0)
	if %4 then mA2 else NoSuchField0
NoSuchField0:
	fail NoSuchField
mA2:
	%5 = getelt(%this, %4)
	ret %5

mB(%this):
	ret 0

main:
	%1 = alloc(3)
	store(%1, @vtblA)
	%2 = %1 + 8
	store(%2, @fieldsA)
	%x0 = %1
	%3 = %x0 & 1
	if %3 then NotAPointer1 else main1
NotAPointer1:
	fail NotAPointer
main1:
	%4 = %x0 + 8
	%5 = load(%4)
	%6 = getelt(%5, 0)
	if %6 then main2 else NoSuchField1
NoSuchField1:
	fail NoSuchField
main2:
	setelt(%x0, %6, 3)
	%7 = %x0 & 1
	if %7 then NotAPointer2 else main3
NotAPointer2:
	fail NotAPointer
main3:
	%8 = load(%x0)
	%9 = getelt(%8, 0)
	if %9 then main4 else NoSuchMethod0
NoSuchMethod0:
	fail NoSuchMethod
main4:
	%10 = call(%9, %x0)
	print(%10)
	ret 0