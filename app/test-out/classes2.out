data:
global array vtblA: { mA }
global array fieldsA: { 2, 0 }
global array vtblB: { mB }
global array fieldsB: { 0, 2 }
code:

mA(%this):
	%0 = %this & 1
	if %0 then NotAPointer0 else mA1
NotAPointer0:
	fail NotAPointer
mA1:
	%1 = %this + 8
	%2 = load(%1)
	%3 = getelt(%2, 0)
	if %3 then mA2 else NoSuchField0
NoSuchField0:
	fail NoSuchField
mA2:
	%4 = getelt(%this, %3)
	%5 = %4
	ret %5

mB(%this):
	ret 0

main:
	%0 = alloc(3)
	store(%0, @vtblA)
	%1 = %0 + 8
	store(%1, @fieldsA)
	%x0 = %0
	%2 = %x0 & 1
	if %2 then NotAPointer1 else main1
NotAPointer1:
	fail NotAPointer
main1:
	%3 = %x0 + 8
	%4 = load(%3)
	%5 = getelt(%4, 0)
	if %5 then main2 else NoSuchField1
NoSuchField1:
	fail NoSuchField
main2:
	setelt(%x0, %5, 3)
	%6 = %x0 & 1
	if %6 then NotAPointer2 else main3
NotAPointer2:
	fail NotAPointer
main3:
	%7 = load(%x0)
	%8 = getelt(%7, 0)
	if %8 then main4 else NoSuchMethod0
NoSuchMethod0:
	fail NoSuchMethod
main4:
	%9 = call(%8, %x0)
	%10 = %9
	%11 = %10 & 1
	if %11 then main5 else NotANumber0
main5:
	%12 = %10 - 1
	%13 = %12 >> 1
	print(%13)
	ret 0
NotANumber0:
	fail NotANumber